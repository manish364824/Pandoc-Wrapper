language: perl
perl:
  - "5.26"
  - "5.24"
  - "5.22"
  - "5.20"
  - "5.18"
  - "5.16"
  - "5.14"

install:
  - cpanm --installdeps .
  - cpanm --quiet --notest --skip-satisfied Dist::Milla

before_script:
  - export PATH=~/.pandoc/bin:$PATH
  - mkdir -p ~/.pandoc/filters
  - perl -Ilib -MPandoc::Release -E 'say latest->download->symlink->bin'
  - find ~/.pandoc
  - pandoc --version

script:
  - milla smoke --release --author
  - cpanm --quiet --notest Pandoc::Elements

after_success:
  - cpanm --quiet --notest --skip-satisfied Devel::Cover::Report::Coveralls
  - perl Build.PL && ./Build build && cover -test -report coveralls

